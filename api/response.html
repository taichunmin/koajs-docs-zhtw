<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Response | Koa</title>
    <meta name="description" content="Node.js 的新時代網站開發框架">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.e12a2e82.css" as="style"><link rel="preload" href="/assets/js/app.cfe081ae.js" as="script"><link rel="preload" href="/assets/js/2.2aa01fdc.js" as="script"><link rel="preload" href="/assets/js/8.587feb79.js" as="script"><link rel="prefetch" href="/assets/js/10.2a47a478.js"><link rel="prefetch" href="/assets/js/11.58872877.js"><link rel="prefetch" href="/assets/js/12.211d2f48.js"><link rel="prefetch" href="/assets/js/13.3c1dec54.js"><link rel="prefetch" href="/assets/js/14.bed908c5.js"><link rel="prefetch" href="/assets/js/15.63a749ac.js"><link rel="prefetch" href="/assets/js/16.19a55eab.js"><link rel="prefetch" href="/assets/js/3.9811ca3e.js"><link rel="prefetch" href="/assets/js/4.cc687f9f.js"><link rel="prefetch" href="/assets/js/5.3f7ed597.js"><link rel="prefetch" href="/assets/js/6.7fe4d02e.js"><link rel="prefetch" href="/assets/js/7.9d338057.js"><link rel="prefetch" href="/assets/js/9.499e59cc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e12a2e82.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Koa</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/koajs/koa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/koajs/examples" target="_blank" rel="noopener noreferrer" class="nav-link external">
  範例
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/koajs/koa/wiki" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Middleware 與 Wiki
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/koajs/koa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/koajs/examples" target="_blank" rel="noopener noreferrer" class="nav-link external">
  範例
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/koajs/koa/wiki" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Middleware 與 Wiki
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/api/" class="sidebar-link">安裝</a></li><li><a href="/api/context.html" class="sidebar-link">Context</a></li><li><a href="/api/request.html" class="sidebar-link">Request</a></li><li><a href="/api/response.html" class="active sidebar-link">Response</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/api/response.html#api" class="sidebar-link">API</a></li></ul></li><li><a href="/guide.html" class="sidebar-link">Guide</a></li><li><a href="/faq.html" class="sidebar-link">Frequently Asked Questions</a></li><li><a href="/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/koa-vs-express.html" class="sidebar-link">/koa-vs-express.html</a></li><li><a href="/migration.html" class="sidebar-link">Migrating from Koa v1.x to v2.x</a></li><li><a href="/troubleshooting.html" class="sidebar-link">Troubleshooting Koa</a></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="response"><a href="#response" aria-hidden="true" class="header-anchor">#</a> Response</h1> <p>A Koa <code>Response</code> object is an abstraction on top of node's vanilla response object,
providing additional functionality that is useful for every day HTTP server
development.</p> <h2 id="api"><a href="#api" aria-hidden="true" class="header-anchor">#</a> API</h2> <h3 id="response-header"><a href="#response-header" aria-hidden="true" class="header-anchor">#</a> response.header</h3> <p>Response header object.</p> <h3 id="response-headers"><a href="#response-headers" aria-hidden="true" class="header-anchor">#</a> response.headers</h3> <p>Response header object. Alias as <code>response.header</code>.</p> <h3 id="response-socket"><a href="#response-socket" aria-hidden="true" class="header-anchor">#</a> response.socket</h3> <p>Request socket.</p> <h3 id="response-status"><a href="#response-status" aria-hidden="true" class="header-anchor">#</a> response.status</h3> <p>Get response status. By default, <code>response.status</code> is set to <code>404</code> unlike node's <code>res.statusCode</code> which defaults to <code>200</code>.</p> <h3 id="response-status-2"><a href="#response-status-2" aria-hidden="true" class="header-anchor">#</a> response.status=</h3> <p>Set response status via numeric code:</p> <ul><li>100 &quot;continue&quot;</li> <li>101 &quot;switching protocols&quot;</li> <li>102 &quot;processing&quot;</li> <li>200 &quot;ok&quot;</li> <li>201 &quot;created&quot;</li> <li>202 &quot;accepted&quot;</li> <li>203 &quot;non-authoritative information&quot;</li> <li>204 &quot;no content&quot;</li> <li>205 &quot;reset content&quot;</li> <li>206 &quot;partial content&quot;</li> <li>207 &quot;multi-status&quot;</li> <li>208 &quot;already reported&quot;</li> <li>226 &quot;im used&quot;</li> <li>300 &quot;multiple choices&quot;</li> <li>301 &quot;moved permanently&quot;</li> <li>302 &quot;found&quot;</li> <li>303 &quot;see other&quot;</li> <li>304 &quot;not modified&quot;</li> <li>305 &quot;use proxy&quot;</li> <li>307 &quot;temporary redirect&quot;</li> <li>308 &quot;permanent redirect&quot;</li> <li>400 &quot;bad request&quot;</li> <li>401 &quot;unauthorized&quot;</li> <li>402 &quot;payment required&quot;</li> <li>403 &quot;forbidden&quot;</li> <li>404 &quot;not found&quot;</li> <li>405 &quot;method not allowed&quot;</li> <li>406 &quot;not acceptable&quot;</li> <li>407 &quot;proxy authentication required&quot;</li> <li>408 &quot;request timeout&quot;</li> <li>409 &quot;conflict&quot;</li> <li>410 &quot;gone&quot;</li> <li>411 &quot;length required&quot;</li> <li>412 &quot;precondition failed&quot;</li> <li>413 &quot;payload too large&quot;</li> <li>414 &quot;uri too long&quot;</li> <li>415 &quot;unsupported media type&quot;</li> <li>416 &quot;range not satisfiable&quot;</li> <li>417 &quot;expectation failed&quot;</li> <li>418 &quot;I'm a teapot&quot;</li> <li>422 &quot;unprocessable entity&quot;</li> <li>423 &quot;locked&quot;</li> <li>424 &quot;failed dependency&quot;</li> <li>426 &quot;upgrade required&quot;</li> <li>428 &quot;precondition required&quot;</li> <li>429 &quot;too many requests&quot;</li> <li>431 &quot;request header fields too large&quot;</li> <li>500 &quot;internal server error&quot;</li> <li>501 &quot;not implemented&quot;</li> <li>502 &quot;bad gateway&quot;</li> <li>503 &quot;service unavailable&quot;</li> <li>504 &quot;gateway timeout&quot;</li> <li>505 &quot;http version not supported&quot;</li> <li>506 &quot;variant also negotiates&quot;</li> <li>507 &quot;insufficient storage&quot;</li> <li>508 &quot;loop detected&quot;</li> <li>510 &quot;not extended&quot;</li> <li>511 &quot;network authentication required&quot;</li></ul> <p><strong>NOTE</strong>: don't worry too much about memorizing these strings,
if you have a typo an error will be thrown, displaying this list
so you can make a correction.</p> <h3 id="response-message"><a href="#response-message" aria-hidden="true" class="header-anchor">#</a> response.message</h3> <p>Get response status message. By default, <code>response.message</code> is
associated with <code>response.status</code>.</p> <h3 id="response-message-2"><a href="#response-message-2" aria-hidden="true" class="header-anchor">#</a> response.message=</h3> <p>Set response status message to the given value.</p> <h3 id="response-length"><a href="#response-length" aria-hidden="true" class="header-anchor">#</a> response.length=</h3> <p>Set response Content-Length to the given value.</p> <h3 id="response-length-2"><a href="#response-length-2" aria-hidden="true" class="header-anchor">#</a> response.length</h3> <p>Return response Content-Length as a number when present, or deduce
from <code>ctx.body</code> when possible, or <code>undefined</code>.</p> <h3 id="response-body"><a href="#response-body" aria-hidden="true" class="header-anchor">#</a> response.body</h3> <p>Get response body.</p> <h3 id="response-body-2"><a href="#response-body-2" aria-hidden="true" class="header-anchor">#</a> response.body=</h3> <p>Set response body to one of the following:</p> <ul><li><code>string</code> written</li> <li><code>Buffer</code> written</li> <li><code>Stream</code> piped</li> <li><code>Object</code> || <code>Array</code> json-stringified</li> <li><code>null</code> no content response</li></ul> <p>If <code>response.status</code> has not been set, Koa will automatically set the status to <code>200</code> or <code>204</code>.</p> <p>Koa doesn't guard against everything that could be put as a response body -- a function doesn't serialise meaningfully, returning a boolean may make sense based on your application, and while an error works, it may not work as intended as some properties of an error are not enumerable.  We recommend adding middleware in your app that asserts body types per app.  A sample middleware might be:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>app.use(async (ctx, next) =&gt; {
  await next()

  ctx.assert.equal('object', typeof ctx, 500, 'some dev did something wrong')
})
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="string"><a href="#string" aria-hidden="true" class="header-anchor">#</a> String</h4> <p>The Content-Type is defaulted to text/html or text/plain, both with
a default charset of utf-8. The Content-Length field is also set.</p> <h4 id="buffer"><a href="#buffer" aria-hidden="true" class="header-anchor">#</a> Buffer</h4> <p>The Content-Type is defaulted to application/octet-stream, and Content-Length
is also set.</p> <h4 id="stream"><a href="#stream" aria-hidden="true" class="header-anchor">#</a> Stream</h4> <p>The Content-Type is defaulted to application/octet-stream.</p> <p>Whenever a stream is set as the response body, <code>.onerror</code> is automatically added as a listener to the <code>error</code> event to catch any errors.
In addition, whenever the request is closed (even prematurely), the stream is destroyed.
If you do not want these two features, do not set the stream as the body directly.
For example, you may not want this when setting the body as an HTTP stream in a proxy as it would destroy the underlying connection.</p> <p>See: https://github.com/koajs/koa/pull/612 for more information.</p> <p>Here's an example of stream error handling without automatically destroying the stream:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> PassThrough <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'stream'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>PassThrough<span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> ctx <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> someHTTPStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> ctx<span class="token punctuation">.</span>onerror<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">PassThrough</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="object"><a href="#object" aria-hidden="true" class="header-anchor">#</a> Object</h4> <p>The Content-Type is defaulted to application/json. This includes plain objects <code>{ foo: 'bar' }</code> and arrays <code>['foo', 'bar']</code>.</p> <h3 id="response-get-field"><a href="#response-get-field" aria-hidden="true" class="header-anchor">#</a> response.get(field)</h3> <p>Get a response header field value with case-insensitive <code>field</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> etag <span class="token operator">=</span> ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'ETag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="response-set-field-value"><a href="#response-set-field-value" aria-hidden="true" class="header-anchor">#</a> response.set(field, value)</h3> <p>Set response header <code>field</code> to <code>value</code>:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'Cache-Control'</span><span class="token punctuation">,</span> <span class="token string">'no-cache'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="response-append-field-value"><a href="#response-append-field-value" aria-hidden="true" class="header-anchor">#</a> response.append(field, value)</h3> <p>Append additional header <code>field</code> with value <code>val</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'Link'</span><span class="token punctuation">,</span> <span class="token string">'&lt;http://127.0.0.1/&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="response-set-fields"><a href="#response-set-fields" aria-hidden="true" class="header-anchor">#</a> response.set(fields)</h3> <p>Set several response header <code>fields</code> with an object:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">'Etag'</span><span class="token punctuation">:</span> <span class="token string">'1234'</span><span class="token punctuation">,</span>
  <span class="token string">'Last-Modified'</span><span class="token punctuation">:</span> date
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>This delegates to <a href="https://nodejs.org/dist/latest/docs/api/http.html#http_request_setheader_name_value" target="_blank" rel="noopener noreferrer">setHeader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> which sets or updates headers by specified keys and doesn't reset the entire header.</p> <h3 id="response-remove-field"><a href="#response-remove-field" aria-hidden="true" class="header-anchor">#</a> response.remove(field)</h3> <p>Remove header <code>field</code>.</p> <h3 id="response-type"><a href="#response-type" aria-hidden="true" class="header-anchor">#</a> response.type</h3> <p>Get response <code>Content-Type</code> void of parameters such as &quot;charset&quot;.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> ct <span class="token operator">=</span> ctx<span class="token punctuation">.</span>type<span class="token punctuation">;</span>
<span class="token comment">// =&gt; &quot;image/png&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="response-type-2"><a href="#response-type-2" aria-hidden="true" class="header-anchor">#</a> response.type=</h3> <p>Set response <code>Content-Type</code> via mime string or file extension.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/plain; charset=utf-8'</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'image/png'</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'.png'</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'png'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Note: when appropriate a <code>charset</code> is selected for you, for
example <code>response.type = 'html'</code> will default to &quot;utf-8&quot;. If you need to overwrite <code>charset</code>,
use <code>ctx.set('Content-Type', 'text/html')</code> to set response header field to value directly.</p> <h3 id="response-is-types"><a href="#response-is-types" aria-hidden="true" class="header-anchor">#</a> response.is(types...)</h3> <p>Very similar to <code>ctx.request.is()</code>.
Check whether the response type is one of the supplied types.
This is particularly useful for creating middleware that
manipulate responses.</p> <p>For example, this is a middleware that minifies
all HTML responses except for streams.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> minify <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-minifier'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>body <span class="token operator">||</span> body<span class="token punctuation">.</span>pipe<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token function">isBuffer</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span> body <span class="token operator">=</span> body<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token function">minify</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="response-redirect-url-alt"><a href="#response-redirect-url-alt" aria-hidden="true" class="header-anchor">#</a> response.redirect(url, [alt])</h3> <p>Perform a [302] redirect to <code>url</code>.</p> <p>The string &quot;back&quot; is special-cased
to provide Referrer support, when Referrer
is not present <code>alt</code> or &quot;/&quot; is used.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'back'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'back'</span><span class="token punctuation">,</span> <span class="token string">'/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'http://google.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>To alter the default status of <code>302</code>, simply assign the status
before or after this call. To alter the body, assign it after this call:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">301</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">'/cart'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'Redirecting to shopping cart'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="response-attachment-filename-options"><a href="#response-attachment-filename-options" aria-hidden="true" class="header-anchor">#</a> response.attachment([filename], [options])</h3> <p>Set <code>Content-Disposition</code> to &quot;attachment&quot; to signal the client
to prompt for download. Optionally specify the <code>filename</code> of the
download and some <a href="https://github.com/jshttp/content-disposition#options" target="_blank" rel="noopener noreferrer">options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="response-headersent"><a href="#response-headersent" aria-hidden="true" class="header-anchor">#</a> response.headerSent</h3> <p>Check if a response header has already been sent. Useful for seeing
if the client may be notified on error.</p> <h3 id="response-lastmodified"><a href="#response-lastmodified" aria-hidden="true" class="header-anchor">#</a> response.lastModified</h3> <p>Return the <code>Last-Modified</code> header as a <code>Date</code>, if it exists.</p> <h3 id="response-lastmodified-2"><a href="#response-lastmodified-2" aria-hidden="true" class="header-anchor">#</a> response.lastModified=</h3> <p>Set the <code>Last-Modified</code> header as an appropriate UTC string.
You can either set it as a <code>Date</code> or date string.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>lastModified <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="response-etag"><a href="#response-etag" aria-hidden="true" class="header-anchor">#</a> response.etag=</h3> <p>Set the ETag of a response including the wrapped <code>&quot;</code>s.
Note that there is no corresponding <code>response.etag</code> getter.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>ctx<span class="token punctuation">.</span>response<span class="token punctuation">.</span>etag <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="response-vary-field"><a href="#response-vary-field" aria-hidden="true" class="header-anchor">#</a> response.vary(field)</h3> <p>Vary on <code>field</code>.</p> <h3 id="response-flushheaders"><a href="#response-flushheaders" aria-hidden="true" class="header-anchor">#</a> response.flushHeaders()</h3> <p>Flush any set headers, and begin the body.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/api/request.html" class="prev">
          Request
        </a></span> <span class="next"><a href="/guide.html">
          Guide
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cfe081ae.js" defer></script><script src="/assets/js/2.2aa01fdc.js" defer></script><script src="/assets/js/8.587feb79.js" defer></script>
  </body>
</html>
